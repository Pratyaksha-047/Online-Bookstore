{% extends "base.html" %}
{% block content %}
  <article class="media content-section">
    <img class="book-img" src="{{ url_for('static', filename='img/books/' + book.image_file) }}">
    <div class="media-body">
      <div class="article-metadata">
        <h2 class="book-title">{{ book.title }}</h2>
        <h3><small class="text-muted">{{ book.author }}</small></h3>
      </div>
	  <h5 class="article-content">&#8377;{{ book.price }}</h5>
	  <h6 class="article-content">About Book : </h6>
      <p class="article-content">{{ book.description }}</h2>
	  <h6 class="article-content">Genre: {{ book.genre }}</h6>
      <h6 class="article-content">Publication Year: {{ book.publishing_year }}</h6>
	  {% if book.nocopies==0: %}
		<h2 class="book-title">Out Of Stock</h2>
	  {% else: %}
		<div>
			<!--<a class="btn btn-success btn-sm mt-1 mb-1" >Buy now</a>-->
      <div class="container text-center p-5">

          <button id="rzp-button1">Pay</button>
          <script src="https://checkout.razorpay.com/v1/checkout.js"></script>
          <script>
            var options = {
            "key": "rzp_test_OPH3Y9PSTTXz6z", // Enter the Key ID generated from the Dashboard
            "amount": "{{payment['amount']}}", // Amount is in currency subunits. Default currency is INR. Hence, 50000 refers to 50000 paise
            "currency": "INR",
            "name": "Online Bookstore",
            "description": "Test Transaction",
            "image": "https://example.com/your_logo",
            "order_id": "{{payment['id']}}", //This is a sample Order ID. Pass the `id` obtained in the response of Step 1
            "handler": function (response){
              alert(response.razorpay_payment_id);
              alert(response.razorpay_order_id);
              alert(response.razorpay_signature)

            },
            "prefill": {
            "name": "{{current_user.name}}",
            "email": "{{current_user.email}}",
            "contact": "{{current_user.phone}}"
            },

          "theme": {
            "color": "#C19A6B"
          }
        };
        var rzp1 = new Razorpay(options);
        rzp1.on('payment.failed', function (response){
        alert(response.error.code);
        alert(response.error.description);
        alert(response.error.source);
        alert(response.error.step);
        alert(response.error.reason);
        alert(response.error.metadata.order_id);
        alert(response.error.metadata.payment_id);
        });
        document.getElementById('rzp-button1').onclick = function(e){
        rzp1.open();
        e.preventDefault();
      }
    </script>
  

  </div>
		</div>
	  {% endif %}
    </div>
  </article>
{% endblock content %}